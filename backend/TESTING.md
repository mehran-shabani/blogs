# ?? ??????? ??? Backend

## ??? ???? API

### 1. ????? ????? ????

```bash
curl http://localhost:8000/api/health
```

??????:
```json
{
  "status": "healthy",
  "message": "?? API ?? ??? ???? ???"
}
```

### 2. ??? ?????? URL

```bash
curl -X POST "http://localhost:8000/api/ingest-url" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://fa.wikipedia.org/wiki/???_??????"
  }'
```

### 3. ??? ???????

```bash
curl -X POST "http://localhost:8000/api/search" \
  -H "Content-Type: application/json" \
  -d '{
    "query": "??? ?????? ?????",
    "use_web_search": false,
    "top_k": 5
  }'
```

### 4. ??? ???????

#### ?????? ???????
```bash
curl http://localhost:8000/api/config
```

#### ??????????? ???????
```bash
curl -X POST "http://localhost:8000/api/config" \
  -H "Content-Type: application/json" \
  -d '{
    "api_key": "sk-your-new-key",
    "base_url": "https://api.gapgpt.app/v1"
  }'
```

## ??????? ?? Swagger UI

1. ?? ???? http://localhost:8000/docs ?????
2. ???? API?? ?? ?? ???? ?????? ??? ????

## ??? ?? Python

```python
import requests

BASE_URL = "http://localhost:8000"

# ??? health
response = requests.get(f"{BASE_URL}/api/health")
print(response.json())

# ??? search
response = requests.post(f"{BASE_URL}/api/search", json={
    "query": "??????? ?????",
    "use_web_search": False,
    "top_k": 5
})
print(response.json())
```

## ??? ???? (Unit Tests)

```bash
# ??? pytest
pip install pytest pytest-asyncio

# ????? ??????
pytest tests/ -v
```

## ??? ??? (Load Testing)

```bash
# ??? locust
pip install locust

# ????? ??? ???
locust -f tests/load_test.py
```

????? `load_test.py`:

```python
from locust import HttpUser, task, between

class SearchUser(HttpUser):
    wait_time = between(1, 3)
    
    @task
    def search(self):
        self.client.post("/api/search", json={
            "query": "???",
            "use_web_search": False,
            "top_k": 5
        })
```

## ??????

```bash
# ?????? ??????? ????
tail -f backend.log
```
